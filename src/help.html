<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lasca - Help & Rules (7√ó7 and 8√ó8)</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        line-height: 1.6;
        color: #e8e6e3;
        background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: rgba(42, 42, 42, 0.95);
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      }

      h1 {
        color: #fff;
        font-size: 2.5em;
        margin-bottom: 10px;
        border-bottom: 3px solid #4a9eff;
        padding-bottom: 10px;
      }

      h2 {
        color: #4a9eff;
        font-size: 1.8em;
        margin-top: 30px;
        margin-bottom: 15px;
      }

      h3 {
        color: #7db3ff;
        font-size: 1.3em;
        margin-top: 20px;
        margin-bottom: 10px;
      }

      p {
        margin-bottom: 15px;
        color: #d4d4d4;
      }

      ul,
      ol {
        margin-left: 25px;
        margin-bottom: 15px;
      }

      li {
        margin-bottom: 8px;
        color: #d4d4d4;
      }

      .highlight {
        background: rgba(74, 158, 255, 0.2);
        padding: 15px;
        border-left: 4px solid #4a9eff;
        border-radius: 4px;
        margin: 15px 0;
      }

      .warning {
        background: rgba(255, 184, 77, 0.2);
        padding: 15px;
        border-left: 4px solid #ffb84d;
        border-radius: 4px;
        margin: 15px 0;
      }

      .rule-box {
        background: rgba(74, 158, 255, 0.1);
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border: 1px solid rgba(74, 158, 255, 0.3);
      }

      .key {
        display: inline-block;
        background: rgba(255, 255, 255, 0.1);
        padding: 4px 10px;
        border-radius: 4px;
        font-family: "Courier New", monospace;
        border: 1px solid rgba(255, 255, 255, 0.2);
        font-size: 0.95em;
      }

      .emoji {
        font-size: 1.2em;
      }

      a {
        color: #4a9eff;
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      .back-link {
        display: inline-block;
        margin-top: 30px;
        padding: 12px 24px;
        background: #4a9eff;
        color: white;
        border-radius: 6px;
        font-weight: 600;
        transition: background 0.2s;
      }

      .back-link:hover {
        background: #357abd;
        text-decoration: none;
      }

      code {
        background: rgba(0, 0, 0, 0.3);
        padding: 2px 6px;
        border-radius: 3px;
        font-family: "Courier New", monospace;
        font-size: 0.9em;
      }

      .piece-symbol {
        display: inline-block;
        font-weight: bold;
        padding: 2px 8px;
        border-radius: 4px;
      }

      .white-piece {
        background: rgba(255, 255, 255, 0.2);
        color: #fff;
      }

      .black-piece {
        background: rgba(0, 0, 0, 0.4);
        color: #ddd;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1><span class="emoji">üé≤</span> Lasca - Help & Rules (7√ó7 and 8√ó8)</h1>

      <p>
        <em
          >A strategic board game invented by World Chess Champion Emanuel
          Lasker in 1911</em
        >
      </p>

      <h2>Table of Contents</h2>
      <ul>
        <li><a href="#about">About Lasca</a></li>
        <li><a href="#setup">Game Setup</a></li>
        <li><a href="#rules">Game Rules</a></li>
        <li><a href="#interface">Using the Interface</a></li>
        <li><a href="#features">Features</a></li>
        <li><a href="#tips">Strategy Tips</a></li>
      </ul>

      <h2 id="about">About Lasca</h2>
      <p>
        Lasca (also known as Laska) is a checkers variant that combines elements
        of checkers and chess. This app supports both the classic 7√ó7 Lasca
        board and an 8√ó8 board (Lasca rules on a Dama-sized board).
      </p>

      <div class="highlight">
        <strong>Key Innovation:</strong> When you capture an opponent's piece,
        it doesn't leave the board‚Äîit goes under your piece forming a stack (or
        "column"). The top piece controls the stack, and captured pieces can be
        liberated if their stack is captured!
      </div>

      <h2 id="setup">Game Setup</h2>
      <p>
        Lasca rules are the same on both board sizes. The difference is the
        board and starting piece count.
      </p>
      <ul>
        <li><strong>Classic Lasca (7√ó7):</strong> 11 soldiers per side</li>
        <li><strong>Lasca on 8√ó8 board:</strong> 12 soldiers per side</li>
        <li>
          <span class="piece-symbol white-piece">‚ö™ Light</span> starts at the
          bottom; <span class="piece-symbol black-piece">‚ö´ Dark</span> starts
          at the top
        </li>
        <li>Light moves first</li>
        <li>All pieces start as soldiers (simple pieces)</li>
      </ul>

      <h2 id="rules">Game Rules</h2>

      <div class="rule-box">
        <h3>Movement</h3>
        <ul>
          <li>
            <strong>Soldiers:</strong> Move forward diagonally one square (like
            checkers pawns)
          </li>
          <li>
            <strong>Officers:</strong> Move diagonally in any direction one
            square (like chess kings)
          </li>
          <li>
            You can only move to empty squares (no jumping over your own pieces
            to move)
          </li>
        </ul>
      </div>

      <div class="rule-box">
        <h3>Capturing</h3>
        <ul>
          <li>
            Jump over an enemy piece diagonally to an empty square two spaces
            away
          </li>
          <li>
            The captured piece goes <strong>underneath</strong> your piece,
            forming or extending a stack
          </li>
          <li>
            <strong>Soldiers</strong> can only capture forward (like normal
            moves)
          </li>
          <li>
            <strong>Officers</strong> can capture in any diagonal direction
          </li>
          <li>
            You can only capture enemy pieces (the top piece of enemy stacks)
          </li>
        </ul>
      </div>

      <div class="rule-box">
        <h3>Multi-Capture</h3>
        <ul>
          <li>
            If after capturing you can make another capture, you
            <strong>must continue</strong>
          </li>
          <li>Multi-captures happen in a single turn</li>
          <li>
            <strong>Anti-loop Rule:</strong> You cannot jump over the same
            square twice during one turn
          </li>
          <li>
            If you promote to an officer during a capture sequence, the turn
            ends immediately
          </li>
        </ul>
      </div>

      <div class="rule-box">
        <h3>Promotion</h3>
        <ul>
          <li>
            Soldiers reaching the opposite end of the board promote to
            <strong>Officers</strong> <span class="emoji">‚≠ê</span>
          </li>
          <li>
            Light soldiers promote on row 6 (top of board), Dark soldiers on row
            0 (bottom of board)
          </li>
          <li>Light officers are displayed in green, Dark officers in red</li>
          <li>Officers can move and capture in all four diagonal directions</li>
          <li>
            Only the top piece of a stack determines movement‚Äîofficers control
            their entire stack
          </li>
        </ul>
      </div>

      <div class="rule-box">
        <h3>Stacks</h3>
        <ul>
          <li>When you capture, the enemy piece goes under your piece</li>
          <li>Multiple captures create taller stacks</li>
          <li>
            Only the <strong>top piece</strong> determines who controls the
            stack and how it moves
          </li>
          <li>
            If a stack is captured, the top piece is removed and the next piece
            takes control
          </li>
          <li>
            Pieces of the same color can be in the same stack (from
            multi-captures)
          </li>
        </ul>
      </div>

      <div class="warning">
        <strong>Mandatory Capture Rule:</strong> If you can make a capture, you
        <strong>must</strong> make a capture. You cannot make a quiet move when
        captures are available.
      </div>

      <h3>Winning the Game</h3>
      <p>You win when your opponent:</p>
      <ul>
        <li>
          Has no pieces controlling any stacks (all their pieces are captured
          and under your pieces)
        </li>
        <li>Has no legal moves available (all pieces are blocked)</li>
      </ul>

      <h2 id="interface">Using the Interface</h2>

      <h3>Online play (2 players)</h3>
      <p>
        You can play online via the Start Page by choosing
        <b>Play mode ‚Üí Online</b>. Player 1 creates a room, then shares the
        <b>Room ID</b> with Player 2.
      </p>
      <ul>
        <li>
          Room visibility: when creating a room, choose
          <b>Public</b> (spectators allowed) or <b>Private</b> (no public
          spectating).
        </li>
        <li>
          Room ID is shown in-game in <b>Info ‚Üí Online</b> with a copy button.
        </li>
        <li>
          When you create a room, the game shows a sticky
          <b>Waiting for opponent‚Ä¶</b> toast; tap it to copy an invite link to
          share.
        </li>
        <li>Player 2 joins by pasting the Room ID on the Start Page.</li>
        <li>
          Online input is blocked until both players have joined (prevents one
          client from playing ‚Äúboth colors‚Äù while waiting).
        </li>
        <li>
          Spectating: you can spectate <b>public</b> rooms from the Start Page.
          Private rooms require a secret watch link.
        </li>
        <li>
          Private watch links: seated players can copy a private spectate link
          from <b>Info ‚Üí Online</b> using the <b>‚ìå</b> button.
        </li>
        <li>
          Connection toasts: the game may show <b>Connecting‚Ä¶</b>,
          <b>Reconnecting‚Ä¶</b>, and <b>Reconnected</b>. These respect the ‚ÄúShow
          toast notifications‚Äù setting.
        </li>
        <li>
          Opponent presence: the Online panel shows opponent status, and the
          board also shows a small opponent badge under the turn indicator
          (green=connected, yellow=in grace, red=disconnected, gray=waiting).
        </li>
        <li>
          Report issue: open <b>Info ‚Üí Online</b> and click <b>‚ìò</b> to
          view/copy debug info (and it will also be uploaded to the server for
          this room).
        </li>
        <li>
          Disconnect grace: if one player disconnects while the other stays
          connected, the disconnected player may lose after a short grace
          period. If both players disconnect, the game stays paused and does not
          time out.
        </li>
      </ul>

      <h3>Sound effects</h3>
      <p>
        The game can play subtle sounds for moves/captures. You can toggle this
        from the Start Page (startup option) and in-game from the Options panel.
      </p>

      <h3>Making Moves</h3>
      <ol>
        <li><strong>Click</strong> on one of your pieces to select it</li>
        <li>Valid destinations appear as highlighted circles</li>
        <li><strong>Click</strong> on a destination to move there</li>
        <li>
          If continuing a multi-capture, the piece remains selected‚Äîclick the
          next destination
        </li>
      </ol>

      <h3>Move Hints</h3>
      <p>
        Move preview hints can be toggled in-game via
        <strong>left panel ‚Üí Options ‚Üí Move preview hints</strong>.
      </p>

      <h3>Stack Inspector</h3>
      <p>The right panel shows the composition of stacks:</p>
      <ul>
        <li>Click any stack to see all pieces in it from bottom to top</li>
        <li>The top piece is marked with a star</li>
        <li>Pieces are colored by their owner</li>
      </ul>

      <h3>Board Height Button</h3>
      <p>
        When enabled, an on-board button (‚ÜïÔ∏è) appears near the bottom-right of
        the board to help when the browser‚Äôs bottom navigation bar overlaps the
        play area. You can enable this from the Start Page, or in-game via
        <strong>left panel ‚Üí Options ‚Üí Show resize icon</strong>.
      </p>
      <ul>
        <li><strong>Tap:</strong> toggle reduced board height on/off</li>
        <li>
          <strong>Touch-hold + drag:</strong> move the button if it blocks
          something (its position is remembered)
        </li>
      </ul>

      <h3>Board Notation</h3>
      <p>Lasca uses a standard coordinate system to identify positions:</p>
      <ul>
        <li>
          <strong>Rows:</strong> Numbered 0-6 from bottom to top (0 is bottom, 6
          is top)
        </li>
        <li><strong>Columns:</strong> Numbered 0-6 from left to right</li>
        <li>
          <strong>Format:</strong> Positions are written as
          <code>{Column}{Row}</code>, e.g., <code>A1</code> is the bottom-left
          corner, <code>G7</code> is the top-right corner
        </li>
        <li>Light starts on rows 0-1, Dark starts on rows 5-6</li>
      </ul>
      <p>
        While not displayed in the UI, this notation is standard for recording
        games and discussing positions, similar to algebraic notation in chess.
      </p>

      <h2 id="features">Features</h2>

      <h3>Game Controls</h3>
      <ul>
        <li>
          <strong>New Game:</strong> Start a fresh game (with confirmation)
        </li>
        <li>
          <strong>Resign:</strong> Forfeit the current game (with confirmation)
        </li>
        <li>
          <strong>Leave room (forfeit):</strong> Online-only. Leave the room and
          forfeit immediately (counts as resign), then return to the Start Page.
        </li>
        <li><strong>Undo/Redo:</strong> Navigate through your move history</li>
        <li><strong>Save Game:</strong> Export your game to a JSON file</li>
        <li><strong>Load Game:</strong> Import a previously saved game</li>
        <li>
          <strong>Move History:</strong> See all moves made in the current game
          (shown in the <strong>Info</strong> panel, below the Stack Inspector).
          Quiet moves use ‚Üí (e.g., "A1 ‚Üí B2"), captures use √ó (e.g., "C3 √ó D4").
          Multi-capture chains show the full path (e.g., "A1 √ó B2 √ó C3"). The
          list auto-scrolls so the latest move stays visible. You can also
          <strong>click any entry</strong> (including "Start") to jump to that
          point in the game; when you Undo/Redo or jump, the list scrolls to
          keep the current entry visible.
        </li>
        <li>
          <strong>Export Move History:</strong> Download a JSON file containing
          all moves from the current game with timestamps. Useful for recording
          games for publication or analysis
        </li>
      </ul>

      <h3>Options</h3>
      <p>
        The <strong>Game Panel</strong> (left sidebar) contains an
        <strong>Options</strong> section with display and gameplay settings:
      </p>
      <ul>
        <li>
          <strong>Show board coordinates:</strong> Display column letters (A‚ÄìG)
          and row numbers (1‚Äì7) along the edges of the board
        </li>
      </ul>

      <p>
        Repetition draws are enforced by the ruleset (not a UI option). When a
        threefold repetition is available, the current player may claim a draw;
        fivefold repetition is an automatic draw.
      </p>

      <h3>Option Actions</h3>
      <p>
        Below Options, the <strong>Option Actions</strong> section contains game
        control buttons:
      </p>
      <ul>
        <li>
          <strong>New Game:</strong> Start a fresh game (with confirmation)
        </li>
        <li>
          <strong>Save Game / Load Game:</strong> Export or import game state as
          JSON
        </li>
        <li>
          <strong>Export Move History:</strong> Download move history as JSON
        </li>
        <li><strong>Undo / Redo:</strong> Navigate through move history</li>
        <li>
          <strong>Resign:</strong> Forfeit the current game (with confirmation)
        </li>
        <li>
          <strong>Leave room (forfeit):</strong> Online-only. Leave the room and
          forfeit immediately (counts as resign), then return to the Start Page.
        </li>
      </ul>

      <h3>AI</h3>
      <p>
        The <strong>Game Panel</strong> (left sidebar) includes an
        <strong>AI</strong>
        section that lets you choose who is controlled by the computer.
      </p>
      <ul>
        <li>
          <strong>Light / Dark:</strong> Set each side to Human, Beginner,
          Intermediate, or Expert.
        </li>
        <li>
          <strong>Both sides AI:</strong> If you set both to AI, the game can
          play on its own.
        </li>
        <li>
          <strong>Speed:</strong> Adds a pause between AI moves so play is
          easier to follow.
        </li>
        <li>
          <strong>Pause / Step:</strong> Pause AI play, or step a single move
          (useful for AI vs AI).
        </li>
      </ul>

      <h3>Evaluation</h3>
      <p>
        The <strong>Info</strong> panel (right sidebar) includes an
        <strong>Evaluation</strong> section showing a quick ‚Äúwho is better‚Äù
        style indicator. Click an icon to choose what to display (hover to see
        the tooltip):
      </p>
      <ul>
        <li>
          <strong>‚öñ Advantage (estimate):</strong> A heuristic evaluation of the
          current position
        </li>
        <li>
          <strong>‚ñ¶ Controlled stacks:</strong> Count of stacks controlled by
          each side (top piece)
        </li>
        <li>
          <strong>‚õÄ Material (all pieces):</strong> All pieces currently on the
          board, including buried
        </li>
      </ul>

      <h3>Themes</h3>
      <p>Choose between different visual themes:</p>
      <ul>
        <li><strong>Classic:</strong> Traditional tan and brown board</li>
        <li>
          <strong>Wooden:</strong> Natural wood grain textures with light maple,
          dark walnut, and cherry wood pieces on a warm wooden board
        </li>
        <li>
          <strong>Copper & Steel:</strong> Modern metallic theme with polished
          stainless steel and copper pieces featuring brushed metal textures and
          realistic metallic shine
        </li>
        <li>
          <strong>Granite & Marble:</strong> Elegant stone theme with polished
          white marble and black granite pieces featuring realistic veining,
          bright reflective speckles, and rounded beveled edges for a
          dimensional 3D appearance
        </li>
        <li>
          <strong>Semi-Precious Stones:</strong> Gem-like theme with
          semi-precious pieces (11 light + 11 dark) and enhanced shine (strong
          speculars/glints) to make stones easier to identify at a glance
        </li>
        <li>
          <strong>Glass:</strong> Sleek translucent glass pieces in light yellow
          and dark blue with shiny reflections, rounded edges, and glossy
          highlights for a modern appearance. Includes optional piece color-pair
          presets (Glass colors) and background variants (Original / Felt /
          Walnut), selectable from the Theme panel or the Start Page.
        </li>
        <li>
          <strong>Turtle:</strong> Turtle-shell patterned pieces with Dark in
          green and Light in a light yellowish orange-brown
        </li>
        <li>
          <strong>Porcelain:</strong> Smooth glazed ceramic pieces with a clean,
          polished look
        </li>
        <li>
          <strong>Luminous:</strong> Incandescent-style pieces with a warm glow
          and strong halo
        </li>
      </ul>

      <h3>Developer Tools</h3>
      <p>In development mode (console):</p>
      <ul>
        <li><code>__random()</code> - Generate a random game state</li>
        <li><code>__random(11, "B")</code> - Random state with Dark to move</li>
        <li>
          <code>__random(11, "W", "R")</code> - Test scenario for anti-loop rule
        </li>
      </ul>

      <h2 id="tips">Strategy Tips</h2>
      <ul>
        <li>
          <strong>Control the Center:</strong> Like chess, controlling central
          squares gives more mobility
        </li>
        <li>
          <strong>Build Stacks:</strong> Taller stacks are harder to eliminate
          completely
        </li>
        <li>
          <strong>Promote Carefully:</strong> Promoting during a multi-capture
          ends that turn immediately, but officers can make multi-captures in
          future turns
        </li>
        <li>
          <strong>Force Trades:</strong> If you have more pieces on top, trading
          stacks works in your favor
        </li>
        <li>
          <strong>Watch for Traps:</strong> Setting up forced captures can win
          material
        </li>
        <li>
          <strong>Liberation:</strong> Capturing opponent stacks can liberate
          your own pieces buried inside
        </li>
      </ul>

      <h2>About the Implementation</h2>
      <p>
        This is a modern web implementation built with TypeScript, Vite, and SVG
        rendering. The game includes:
      </p>
      <ul>
        <li>Complete rule implementation with validation</li>
        <li>Comprehensive test coverage</li>
        <li>Undo/redo with full game history</li>
        <li>Save/load functionality</li>
        <li>Anti-loop protection for multi-captures</li>
        <li>Responsive design</li>
      </ul>

      <p>
        <strong>Version:</strong> 1.0<br />
        <strong>Released:</strong> December 2025
      </p>

      <a href="lasca.html" class="back-link">‚Üê Back to Game</a>
      <script>
        (function () {
          try {
            var params = new URLSearchParams(window.location.search);
            if (params.get("from") !== "startHelp") return;

            var a = document.querySelector("a.back-link");
            if (!a) return;
            a.setAttribute("href", "./start-help.html");
            a.textContent = "\u2190 Back to Start Page Help";
          } catch (e) {
            // ignore
          }
        })();
      </script>
    </div>
  </body>
</html>

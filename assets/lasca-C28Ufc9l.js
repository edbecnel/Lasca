(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const ve=["r0c0","r0c2","r0c4","r0c6","r1c1","r1c3","r1c5","r2c0","r2c2","r2c4","r2c6"],Ae=["r4c0","r4c2","r4c4","r4c6","r5c1","r5c3","r5c5","r6c0","r6c2","r6c4","r6c6"],Ce="r3c3",Le=[{owner:"B",rank:"O"},{owner:"W",rank:"S"},{owner:"B",rank:"S"},{owner:"W",rank:"O"},{owner:"B",rank:"S"},{owner:"W",rank:"S"},{owner:"B",rank:"O"},{owner:"W",rank:"S"}];function Ee(){const r=new Map;for(const e of ve)r.set(e,[{owner:"B",rank:"S"}]);for(const e of Ae)r.set(e,[{owner:"W",rank:"S"}]);return r.set(Ce,Le),{board:r,toMove:"W",phase:"select"}}function ce(r){return r.owner==="W"&&r.rank==="S"?"#W_S":r.owner==="W"&&r.rank==="O"?"#W_O":r.owner==="B"&&r.rank==="S"?"#B_S":"#B_O"}const Ie="http://www.w3.org/2000/svg",Be="http://www.w3.org/1999/xlink";function se(r,e,t,i){const n=document.createElementNS(Ie,"use");return n.setAttribute("href",r),n.setAttributeNS(Be,"xlink:href",r),n.setAttribute("width",String(i)),n.setAttribute("height",String(i)),n.setAttribute("x",String(e)),n.setAttribute("y",String(t)),n}const J=6,le=Math.floor(J/2),ye=J-le,P="http://www.w3.org/2000/svg";function Te(r,e,t,i,n,o={}){const{pieceSize:c=86,maxShown:d=J,keepTop:l=ye,keepBottom:a=le,miniSize:s=18,miniGap:f=3,spineGap:h=10,spinePad:m=6,crackGap:w=12}=o,g=n.length;if(g<=1)return;let u=[],p=!1;if(g<=d)u=n.slice();else{p=!0;const B=n.slice(0,a),N=n.slice(g-l);u=B.concat(N)}const y=u.length,O=y*s+(y-1)*f+(p?w:0),v=s+m*2,C=O+m*2,k=t+c/2+h,A=i-C/2,S=document.createElementNS(P,"rect");S.setAttribute("x",String(k)),S.setAttribute("y",String(A)),S.setAttribute("width",String(v)),S.setAttribute("height",String(C)),S.setAttribute("rx","10"),S.setAttribute("fill","rgba(0,0,0,0.28)"),S.setAttribute("stroke","rgba(255,255,255,0.35)"),S.setAttribute("stroke-width","1.4"),S.setAttribute("pointer-events","none"),e.appendChild(S);const W=r.querySelector("defs");if(!W)throw new Error("SVG <defs> not found. miniSpine requires <defs>.");const M=`clip_${Math.random().toString(16).slice(2)}`,T=document.createElementNS(P,"clipPath");T.setAttribute("id",M);const L=document.createElementNS(P,"rect");L.setAttribute("x",String(k+1)),L.setAttribute("y",String(A+1)),L.setAttribute("width",String(v-2)),L.setAttribute("height",String(C-2)),L.setAttribute("rx","9"),T.appendChild(L),W.appendChild(T);const F=document.createElementNS(P,"g");F.setAttribute("clip-path",`url(#${M})`),F.setAttribute("pointer-events","none");const U=k+m,b=A+C-m,x=a-1;for(let B=0;B<y;B++){const N=u[B],_=ce(N);let X=B*(s+f);p&&B>x&&(X+=w);const K=b-s-X,q=U;F.appendChild(se(_,q,K,s))}if(e.appendChild(F),p){const N=b-s-x*(s+f)-f-w/2,_=k+3,X=k+v-3,K=(_+X)/2,q=[`M ${_} ${N-5}`,`L ${K-6} ${N+2}`,`L ${K} ${N-3}`,`L ${K+6} ${N+4}`,`L ${X} ${N-1}`].join(" "),$=document.createElementNS(P,"path");$.setAttribute("d",q),$.setAttribute("fill","none"),$.setAttribute("stroke","rgba(0,0,0,0.45)"),$.setAttribute("stroke-width","4.0"),$.setAttribute("stroke-linecap","round"),$.setAttribute("stroke-linejoin","round"),$.setAttribute("pointer-events","none");const G=document.createElementNS(P,"path");G.setAttribute("d",q),G.setAttribute("fill","none"),G.setAttribute("stroke","rgba(255,255,255,0.75)"),G.setAttribute("stroke-width","2.2"),G.setAttribute("stroke-linecap","round"),G.setAttribute("stroke-linejoin","round"),G.setAttribute("pointer-events","none"),e.appendChild($),e.appendChild(G)}const I=k+v/2,Y=A-12,D=document.createElementNS(P,"circle");D.setAttribute("cx",String(I)),D.setAttribute("cy",String(Y)),D.setAttribute("r","10"),D.setAttribute("fill","rgba(0,0,0,0.78)"),D.setAttribute("stroke","rgba(255,255,255,0.65)"),D.setAttribute("stroke-width","1.4"),D.setAttribute("pointer-events","none");const E=document.createElementNS(P,"text");E.setAttribute("x",String(I)),E.setAttribute("y",String(Y+.5)),E.setAttribute("text-anchor","middle"),E.setAttribute("dominant-baseline","middle"),E.setAttribute("fill","#fff"),E.setAttribute("font-size","12"),E.setAttribute("font-family","system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif"),E.textContent=String(g),E.setAttribute("pointer-events","none"),e.appendChild(D),e.appendChild(E)}function Ne(r,e,t,i,n,o={}){const{pieceSize:c=86}=o,d=document.getElementById(i);if(!d||!n.length)return;const l=parseFloat(d.getAttribute("cx")||"0"),a=parseFloat(d.getAttribute("cy")||"0"),s=document.createElementNS("http://www.w3.org/2000/svg","g");s.setAttribute("data-node",i),s.setAttribute("class","stack");const f=n[n.length-1],h=c/2;s.appendChild(se(ce(f),l-h,a-h,c)),Te(r,s,l,a,n,{pieceSize:c,miniSize:18}),t&&n.length>1&&(s.style.cursor="pointer",s.addEventListener("pointerenter",()=>{t.cancelHide(),t.show(i,n)}),s.addEventListener("pointerleave",()=>{t.hideSoon()})),e.appendChild(s)}function ke(r,e,t,i){e.textContent="";for(const[n,o]of i.board.entries())Ne(r,e,t,n,o)}const j="http://www.w3.org/2000/svg";function Me(r,e,t){let i=null;function n(){for(;t.firstChild;)t.removeChild(t.firstChild);t.setAttribute("viewBox","0 0 120 200"),t.removeAttribute("height")}function o(l,a){const s=a.length;for(r.textContent=`Stack @ ${l} (×${s})`,e.textContent=s>J?"Full column order (bottom → top). Brackets mark pieces omitted in the mini preview spine.":"Full column order (bottom → top).";t.firstChild;)t.removeChild(t.firstChild);const f=22,h=4,m=26,w=24,g=120,u=s*f+(s-1)*h,p=m+u+w;t.setAttribute("viewBox",`0 0 ${g} ${p}`),t.setAttribute("height",String(p));const y=g/2-f/2,O=m,v=document.createElementNS(j,"rect");v.setAttribute("x",String(y-8)),v.setAttribute("y",String(O-10)),v.setAttribute("width",String(f+16)),v.setAttribute("height",String(u+20)),v.setAttribute("rx","12"),v.setAttribute("fill","rgba(0,0,0,0.28)"),v.setAttribute("stroke","rgba(255,255,255,0.18)"),v.setAttribute("stroke-width","1.4"),t.appendChild(v);const C=document.createElementNS(j,"text");C.setAttribute("x",String(g/2)),C.setAttribute("y",String(O-12)),C.setAttribute("text-anchor","middle"),C.setAttribute("fill","rgba(255,255,255,0.85)"),C.setAttribute("font-size","12"),C.setAttribute("font-family","system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif"),C.textContent="TOP",t.appendChild(C);const k=document.createElementNS(j,"text");k.setAttribute("x",String(g/2)),k.setAttribute("y",String(O+u+18)),k.setAttribute("text-anchor","middle"),k.setAttribute("fill","rgba(255,255,255,0.85)"),k.setAttribute("font-size","12"),k.setAttribute("font-family","system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif"),k.textContent="BOTTOM",t.appendChild(k);for(let A=0;A<s;A++){const S=a[A],W=ce(S),M=O+(s-1-A)*(f+h);t.appendChild(se(W,y,M,f))}if(s>J){const A=le,S=ye,W=A,M=s-S-1;if(M>=W){const T=O+(s-1-M)*(f+h),L=O+(s-1-W)*(f+h)+f,F=y-18,U=y+f+18,b=10,x=document.createElementNS(j,"path");x.setAttribute("d",`M ${F+b} ${T} L ${F} ${T} L ${F} ${L} L ${F+b} ${L}`),x.setAttribute("fill","none"),x.setAttribute("stroke","rgba(255,255,255,0.90)"),x.setAttribute("stroke-width","2.2"),x.setAttribute("stroke-linecap","round"),x.setAttribute("stroke-linejoin","round"),t.appendChild(x);const I=document.createElementNS(j,"path");I.setAttribute("d",`M ${U-b} ${T} L ${U} ${T} L ${U} ${L} L ${U-b} ${L}`),I.setAttribute("fill","none"),I.setAttribute("stroke","rgba(255,255,255,0.90)"),I.setAttribute("stroke-width","2.2"),I.setAttribute("stroke-linecap","round"),I.setAttribute("stroke-linejoin","round"),t.appendChild(I)}}}function c(){i&&clearTimeout(i),i=null}function d(){i&&clearTimeout(i),i=setTimeout(()=>{r.textContent="Lasca Stack Inspector",e.textContent="Hover a stacked piece to see the full column order (bottom → top). If a crack appears on the mini spine, brackets mark the omitted middle here.",n()},80)}return{show:o,hideSoon:d,cancelHide:c,clearZoom:n}}const R="lasca.layout.",V=22,z={leftWidth:280,rightWidth:320,leftCollapsed:!1,rightCollapsed:!1};function H(r,e,t){return Math.max(e,Math.min(t,r))}function fe(r,e){const t=localStorage.getItem(r);if(t==null)return e;const i=Number(t);return Number.isFinite(i)?i:e}function ue(r,e){const t=localStorage.getItem(r);return t==null?e:t==="1"}function he(r,e){localStorage.setItem(r,String(Math.round(e)))}function pe(r,e){localStorage.setItem(r,e?"1":"0")}function De(r={}){const e=r.root??document.getElementById("appRoot"),t=r.left??document.getElementById("leftSidebar"),i=r.right??document.getElementById("rightSidebar"),n=r.gutterLeft??document.getElementById("gutterLeft"),o=r.gutterRight??document.getElementById("gutterRight");if(!e||!t||!i||!n||!o)throw new Error("splitLayout: missing root/sidebars/gutters");const c=e.querySelector('[data-action="collapse-left"]'),d=e.querySelector('[data-action="collapse-right"]'),l=e.querySelector('[data-action="expand-left"]'),a=e.querySelector('[data-action="expand-right"]'),s=420,f=200,h=520,m=240,w=560;let g=fe(R+"leftWidth",z.leftWidth),u=fe(R+"rightWidth",z.rightWidth),p=ue(R+"leftCollapsed",z.leftCollapsed),y=ue(R+"rightCollapsed",z.rightCollapsed),O=g,v=u;function C(){return e.getBoundingClientRect().width}function k(){return n.getBoundingClientRect().width+o.getBoundingClientRect().width}function A(){t.style.width=p?`${V}px`:`${g}px`,i.style.width=y?`${V}px`:`${u}px`,t.classList.toggle("collapsed",p),i.classList.toggle("collapsed",y),n.classList.toggle("disabled",p),o.classList.toggle("disabled",y),he(R+"leftWidth",g),he(R+"rightWidth",u),pe(R+"leftCollapsed",p),pe(R+"rightCollapsed",y)}function S(){const b=C(),x=y?V:u;return b-k()-x-s}function W(){const b=C(),x=p?V:g;return b-k()-x-s}function M(b){p!==b&&(b?O=g:g=H(O,f,Math.min(h,S())),p=b,A())}function T(b){y!==b&&(b?v=u:u=H(v,m,Math.min(w,W())),y=b,A())}function L(){p||(g=H(g,f,Math.min(h,S()))),y||(u=H(u,m,Math.min(w,W()))),A()}function F(b){if(p)return;const x=b.clientX,I=g,Y=Math.min(h,S()),D=f;function E(N){const _=N.clientX-x;g=H(I+_,D,Y),A()}function B(){window.removeEventListener("pointermove",E),window.removeEventListener("pointerup",B);try{n.releasePointerCapture(b.pointerId)}catch{}}n.setPointerCapture(b.pointerId),window.addEventListener("pointermove",E),window.addEventListener("pointerup",B)}function U(b){if(y)return;const x=b.clientX,I=u,Y=Math.min(w,W()),D=m;function E(N){const _=N.clientX-x;u=H(I-_,D,Y),A()}function B(){window.removeEventListener("pointermove",E),window.removeEventListener("pointerup",B);try{o.releasePointerCapture(b.pointerId)}catch{}}o.setPointerCapture(b.pointerId),window.addEventListener("pointermove",E),window.addEventListener("pointerup",B)}return n.addEventListener("pointerdown",F),o.addEventListener("pointerdown",U),n.addEventListener("dblclick",()=>M(!p)),o.addEventListener("dblclick",()=>T(!y)),c==null||c.addEventListener("click",()=>M(!0)),l==null||l.addEventListener("click",()=>M(!1)),d==null||d.addEventListener("click",()=>T(!0)),a==null||a.addEventListener("click",()=>T(!1)),L(),window.addEventListener("resize",L),{getState:()=>({leftWidth:g,rightWidth:u,leftCollapsed:p,rightCollapsed:y}),setLeftCollapsed:M,setRightCollapsed:T,setLeftWidth:b=>{g=b,L()},setRightWidth:b=>{u=b,L()}}}async function Oe(r,e){if(!r)throw new Error("loadSvgFileInto: containerEl is required");const t=await fetch(e);if(!t.ok)throw new Error(`loadSvgFileInto: failed to fetch ${String(e)} (${t.status})`);const i=await t.text(),o=new DOMParser().parseFromString(i,"image/svg+xml").documentElement;if(!o||o.nodeName.toLowerCase()!=="svg")throw new Error(`loadSvgFileInto: ${String(e)} did not parse as an <svg> root`);const c=document.importNode(o,!0);return r.replaceChildren(c),c}async function We(r,e){if(!r)throw new Error("loadSvgDefsInto: targetEl is required");if(!(!Array.isArray(e)||e.length===0))for(const t of e){const i=await fetch(t);if(!i.ok)throw new Error(`loadSvgDefsInto: failed to fetch ${String(t)} (${i.status})`);const n=await i.text(),o=new DOMParser().parseFromString(n,"image/svg+xml"),c=o.querySelector("defs"),d=c?Array.from(c.children):Array.from(o.documentElement.children);for(const l of d)r.appendChild(document.importNode(l,!0))}}const ne="classic",ie=[{id:"classic",label:"Classic",piecesDefs:new URL("data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201%201'%20aria-hidden='true'%3e%3cdefs%3e%3c!--%20========%20PIECE%20SYMBOLS%20(W_S,%20B_S,%20W_O,%20B_O)%20========%20--%3e%3cradialGradient%20id='gradWhite'%20cx='35%25'%20cy='30%25'%20r='70%25'%3e%3cstop%20offset='0%25'%20stop-color='%23ffffff'/%3e%3cstop%20offset='55%25'%20stop-color='%23f1f1f1'/%3e%3cstop%20offset='100%25'%20stop-color='%23d6d6d6'/%3e%3c/radialGradient%3e%3cradialGradient%20id='gradBlack'%20cx='35%25'%20cy='30%25'%20r='70%25'%3e%3cstop%20offset='0%25'%20stop-color='%23444444'/%3e%3cstop%20offset='55%25'%20stop-color='%231c1c1c'/%3e%3cstop%20offset='100%25'%20stop-color='%23050505'/%3e%3c/radialGradient%3e%3cradialGradient%20id='gradGreen'%20cx='35%25'%20cy='30%25'%20r='70%25'%3e%3cstop%20offset='0%25'%20stop-color='%237be58a'/%3e%3cstop%20offset='55%25'%20stop-color='%231fb34a'/%3e%3cstop%20offset='100%25'%20stop-color='%230a6f2a'/%3e%3c/radialGradient%3e%3cradialGradient%20id='gradRed'%20cx='35%25'%20cy='30%25'%20r='70%25'%3e%3cstop%20offset='0%25'%20stop-color='%23ff8f8f'/%3e%3cstop%20offset='55%25'%20stop-color='%23e12a2a'/%3e%3cstop%20offset='100%25'%20stop-color='%238f1111'/%3e%3c/radialGradient%3e%3cpath%20id='star5'%20d='%20M%2050%2030%20L%2056.5%2043.2%20L%2071.0%2045.3%20L%2060.5%2055.6%20L%2063.0%2070.0%20L%2050.0%2063.2%20L%2037.0%2070.0%20L%2039.5%2055.6%20L%2029.0%2045.3%20L%2043.5%2043.2%20Z'%20/%3e%3c!--%20White%20Soldier%20--%3e%3csymbol%20id='W_S'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='43'%20fill='url(%23gradWhite)'%20stroke='%23111'%20stroke-width='6'/%3e%3ccircle%20cx='50'%20cy='50'%20r='33'%20fill='none'%20stroke='%23000'%20stroke-opacity='0.18'%20stroke-width='3'/%3e%3cellipse%20cx='40'%20cy='36'%20rx='18'%20ry='12'%20fill='%23fff'%20opacity='0.28'/%3e%3c/symbol%3e%3c!--%20Black%20Soldier%20--%3e%3csymbol%20id='B_S'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='43'%20fill='url(%23gradBlack)'%20stroke='%23f5f5f5'%20stroke-width='6'/%3e%3ccircle%20cx='50'%20cy='50'%20r='33'%20fill='none'%20stroke='%23fff'%20stroke-opacity='0.16'%20stroke-width='3'/%3e%3cellipse%20cx='40'%20cy='36'%20rx='18'%20ry='12'%20fill='%23fff'%20opacity='0.10'/%3e%3c/symbol%3e%3c!--%20Green%20Officer%20(paired%20with%20White%20Soldier)%20--%3e%3csymbol%20id='W_O'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='43'%20fill='url(%23gradGreen)'%20stroke='%230b2a12'%20stroke-width='6'/%3e%3ccircle%20cx='50'%20cy='50'%20r='33'%20fill='none'%20stroke='%23000'%20stroke-opacity='0.18'%20stroke-width='3'/%3e%3cuse%20href='%23star5'%20fill='%23ffffff'%20opacity='0.95'/%3e%3ccircle%20cx='50'%20cy='50'%20r='18'%20fill='none'%20stroke='%23fff'%20stroke-opacity='0.55'%20stroke-width='3'/%3e%3cellipse%20cx='40'%20cy='36'%20rx='18'%20ry='12'%20fill='%23fff'%20opacity='0.18'/%3e%3c/symbol%3e%3c!--%20Red%20Officer%20(paired%20with%20Black%20Soldier)%20--%3e%3csymbol%20id='B_O'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='43'%20fill='url(%23gradRed)'%20stroke='%233a0b0b'%20stroke-width='6'/%3e%3ccircle%20cx='50'%20cy='50'%20r='33'%20fill='none'%20stroke='%23000'%20stroke-opacity='0.18'%20stroke-width='3'/%3e%3cuse%20href='%23star5'%20fill='%23ffffff'%20opacity='0.95'/%3e%3ccircle%20cx='50'%20cy='50'%20r='18'%20fill='none'%20stroke='%23fff'%20stroke-opacity='0.55'%20stroke-width='3'/%3e%3cellipse%20cx='40'%20cy='36'%20rx='18'%20ry='12'%20fill='%23fff'%20opacity='0.16'/%3e%3c/symbol%3e%3c/defs%3e%3c/svg%3e",import.meta.url),boardDefs:new URL("data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201%201'%20aria-hidden='true'%3e%3cdefs%3e%3c!--%20========%20CONNECTOR%20MASK%20(prevents%20lines%20inside%20nodes)%20========%20--%3e%3cmask%20id='mask-connectors'%20maskUnits='userSpaceOnUse'%20maskContentUnits='userSpaceOnUse'%3e%3crect%20x='0'%20y='0'%20width='1000'%20height='1000'%20fill='white'/%3e%3c!--%20hole%20radius%20chosen%20so%20lines%20can%20tuck%20slightly%20under%20the%20ring%20--%3e%3c!--%20node%20r%20=%2046,%20hole%20r%20=%2042%20--%3e%3c!--%20row%200%20--%3e%3ccircle%20cx='140'%20cy='140'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='140'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='140'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='140'%20r='42'%20fill='black'/%3e%3c!--%20row%201%20--%3e%3ccircle%20cx='260'%20cy='260'%20r='42'%20fill='black'/%3e%3ccircle%20cx='500'%20cy='260'%20r='42'%20fill='black'/%3e%3ccircle%20cx='740'%20cy='260'%20r='42'%20fill='black'/%3e%3c!--%20row%202%20--%3e%3ccircle%20cx='140'%20cy='380'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='380'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='380'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='380'%20r='42'%20fill='black'/%3e%3c!--%20row%203%20--%3e%3ccircle%20cx='260'%20cy='500'%20r='42'%20fill='black'/%3e%3ccircle%20cx='500'%20cy='500'%20r='42'%20fill='black'/%3e%3ccircle%20cx='740'%20cy='500'%20r='42'%20fill='black'/%3e%3c!--%20row%204%20--%3e%3ccircle%20cx='140'%20cy='620'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='620'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='620'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='620'%20r='42'%20fill='black'/%3e%3c!--%20row%205%20--%3e%3ccircle%20cx='260'%20cy='740'%20r='42'%20fill='black'/%3e%3ccircle%20cx='500'%20cy='740'%20r='42'%20fill='black'/%3e%3ccircle%20cx='740'%20cy='740'%20r='42'%20fill='black'/%3e%3c!--%20row%206%20--%3e%3ccircle%20cx='140'%20cy='860'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='860'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='860'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='860'%20r='42'%20fill='black'/%3e%3c/mask%3e%3c/defs%3e%3c/svg%3e",import.meta.url),css:new URL("data:text/css;base64,Lyogc3JjL2Fzc2V0cy90aGVtZXMvY2xhc3NpYy90aGVtZS5jc3MgKi8KOnJvb3R7CiAgLS1wYWdlLWJnOiAjMWIxYjFiOwogIC0tcGFuZWwtYmc6IHJnYmEoMjU1LDI1NSwyNTUsMC4wNik7CiAgLS1wYW5lbC1ib3JkZXI6IHJnYmEoMjU1LDI1NSwyNTUsMC4xMCk7CiAgLS1wYW5lbC10ZXh0OiByZ2JhKDI1NSwyNTUsMjU1LDAuOTApOwogIC0tcGFuZWwtc3VidGV4dDogcmdiYSgyNTUsMjU1LDI1NSwwLjcwKTsKfQoKLyogU2xpZ2h0bHkgd2FybSBib2FyZCBjb25uZWN0b3JzL25vZGVzICovCiNsYXNjYUJvYXJkICNjb25uZWN0b3JzeyBzdHJva2U6ICMxMTE7IH0KI2xhc2NhQm9hcmQgI25vZGVzeyBzdHJva2U6ICMxMTE7IH0K",import.meta.url)},{id:"highContrast",label:"High Contrast",piecesDefs:new URL("data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201%201'%20aria-hidden='true'%3e%3cdefs%3e%3c!--%20High-contrast%20flat%20pieces:%20same%20IDs%20(%23W_S,%20%23B_S,%20%23W_O,%20%23B_O)%20--%3e%3cpath%20id='star5'%20d='%20M%2050%2025%20L%2058%2042%20L%2077%2045%20L%2063%2058%20L%2066%2077%20L%2050%2068%20L%2034%2077%20L%2037%2058%20L%2023%2045%20L%2042%2042%20Z'%20/%3e%3c!--%20White%20Soldier%20--%3e%3csymbol%20id='W_S'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='44'%20fill='%23ffffff'%20stroke='%23000000'%20stroke-width='8'/%3e%3ccircle%20cx='50'%20cy='50'%20r='32'%20fill='none'%20stroke='%23000000'%20stroke-width='6'%20opacity='0.18'/%3e%3cellipse%20cx='38'%20cy='34'%20rx='18'%20ry='12'%20fill='%23000'%20opacity='0.06'/%3e%3c/symbol%3e%3c!--%20Black%20Soldier%20--%3e%3csymbol%20id='B_S'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='44'%20fill='%23000000'%20stroke='%23ffffff'%20stroke-width='8'/%3e%3ccircle%20cx='50'%20cy='50'%20r='32'%20fill='none'%20stroke='%23ffffff'%20stroke-width='6'%20opacity='0.18'/%3e%3cellipse%20cx='38'%20cy='34'%20rx='18'%20ry='12'%20fill='%23fff'%20opacity='0.12'/%3e%3c/symbol%3e%3c!--%20Green%20Officer%20(paired%20with%20White%20Soldier)%20--%3e%3csymbol%20id='W_O'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='44'%20fill='%2321c75a'%20stroke='%23001a08'%20stroke-width='8'/%3e%3cuse%20href='%23star5'%20fill='%23ffffff'%20opacity='0.98'/%3e%3ccircle%20cx='50'%20cy='50'%20r='20'%20fill='none'%20stroke='%23ffffff'%20stroke-width='4'%20opacity='0.7'/%3e%3c/symbol%3e%3c!--%20Red%20Officer%20(paired%20with%20Black%20Soldier)%20--%3e%3csymbol%20id='B_O'%20viewBox='0%200%20100%20100'%3e%3ccircle%20cx='50'%20cy='50'%20r='44'%20fill='%23ff2a2a'%20stroke='%231a0000'%20stroke-width='8'/%3e%3cuse%20href='%23star5'%20fill='%23ffffff'%20opacity='0.98'/%3e%3ccircle%20cx='50'%20cy='50'%20r='20'%20fill='none'%20stroke='%23ffffff'%20stroke-width='4'%20opacity='0.7'/%3e%3c/symbol%3e%3c/defs%3e%3c/svg%3e",import.meta.url),boardDefs:new URL("data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201%201'%20aria-hidden='true'%3e%3cdefs%3e%3c!--%20========%20CONNECTOR%20MASK%20(prevents%20lines%20inside%20nodes)%20========%20--%3e%3cmask%20id='mask-connectors'%20maskUnits='userSpaceOnUse'%20maskContentUnits='userSpaceOnUse'%3e%3crect%20x='0'%20y='0'%20width='1000'%20height='1000'%20fill='white'/%3e%3c!--%20hole%20radius%20chosen%20so%20lines%20can%20tuck%20slightly%20under%20the%20ring%20--%3e%3c!--%20node%20r%20=%2046,%20hole%20r%20=%2042%20--%3e%3c!--%20row%200%20--%3e%3ccircle%20cx='140'%20cy='140'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='140'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='140'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='140'%20r='42'%20fill='black'/%3e%3c!--%20row%201%20--%3e%3ccircle%20cx='260'%20cy='260'%20r='42'%20fill='black'/%3e%3ccircle%20cx='500'%20cy='260'%20r='42'%20fill='black'/%3e%3ccircle%20cx='740'%20cy='260'%20r='42'%20fill='black'/%3e%3c!--%20row%202%20--%3e%3ccircle%20cx='140'%20cy='380'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='380'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='380'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='380'%20r='42'%20fill='black'/%3e%3c!--%20row%203%20--%3e%3ccircle%20cx='260'%20cy='500'%20r='42'%20fill='black'/%3e%3ccircle%20cx='500'%20cy='500'%20r='42'%20fill='black'/%3e%3ccircle%20cx='740'%20cy='500'%20r='42'%20fill='black'/%3e%3c!--%20row%204%20--%3e%3ccircle%20cx='140'%20cy='620'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='620'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='620'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='620'%20r='42'%20fill='black'/%3e%3c!--%20row%205%20--%3e%3ccircle%20cx='260'%20cy='740'%20r='42'%20fill='black'/%3e%3ccircle%20cx='500'%20cy='740'%20r='42'%20fill='black'/%3e%3ccircle%20cx='740'%20cy='740'%20r='42'%20fill='black'/%3e%3c!--%20row%206%20--%3e%3ccircle%20cx='140'%20cy='860'%20r='42'%20fill='black'/%3e%3ccircle%20cx='380'%20cy='860'%20r='42'%20fill='black'/%3e%3ccircle%20cx='620'%20cy='860'%20r='42'%20fill='black'/%3e%3ccircle%20cx='860'%20cy='860'%20r='42'%20fill='black'/%3e%3c/mask%3e%3c/defs%3e%3c/svg%3e",import.meta.url),css:new URL("data:text/css;base64,Lyogc3JjL2Fzc2V0cy90aGVtZXMvaGlnaENvbnRyYXN0L3RoZW1lLmNzcyAqLwo6cm9vdHsKICAtLXBhZ2UtYmc6ICMwYjBiMGI7CiAgLS1wYW5lbC1iZzogcmdiYSgyNTUsMjU1LDI1NSwwLjA4KTsKICAtLXBhbmVsLWJvcmRlcjogcmdiYSgyNTUsMjU1LDI1NSwwLjE0KTsKICAtLXBhbmVsLXRleHQ6IHJnYmEoMjU1LDI1NSwyNTUsMC45NCk7CiAgLS1wYW5lbC1zdWJ0ZXh0OiByZ2JhKDI1NSwyNTUsMjU1LDAuNzgpOwp9CgovKiBNYWtlIGJvYXJkIGxpbmVzL3JpbmdzIG1vcmUgdmlzaWJsZSAqLwojbGFzY2FCb2FyZCAjY29ubmVjdG9yc3sgc3Ryb2tlOiByZ2JhKDI1NSwyNTUsMjU1LDAuODIpOyB9CiNsYXNjYUJvYXJkICNub2Rlc3sgc3Ryb2tlOiByZ2JhKDI1NSwyNTUsMjU1LDAuODIpOyB9CgovKiBCb29zdCBzcGluZSBidWJibGUgY29udHJhc3QgKi8KI2xhc2NhQm9hcmQgdGV4dHsgcGFpbnQtb3JkZXI6IHN0cm9rZTsgc3Ryb2tlOiByZ2JhKDAsMCwwLDAuNTUpOyBzdHJva2Utd2lkdGg6IDJweDsgfQo=",import.meta.url)}];function Q(r){return ie.find(e=>e.id===r)??null}function Fe(r){const{rootEl:e,items:t,initialId:i,onSelect:n}=r??{};if(!e)throw new Error("createThemeDropdown: rootEl is required");if(!Array.isArray(t)||t.length===0)throw new Error("createThemeDropdown: items is required");const o=e.querySelector("#themeDropdownBtn"),c=e.querySelector("#themeDropdownMenu");if(!o||!c)throw new Error("createThemeDropdown: missing #themeDropdownBtn / #themeDropdownMenu");let d=!1,l=i??t[0].id;function a(u){d=u,o.setAttribute("aria-expanded",d?"true":"false"),d?(c.hidden=!1,c.focus({preventScroll:!0})):c.hidden=!0}function s(){const u=t.find(p=>p.id===l)??t[0];o.textContent=u?`${u.label} ▾`:"Theme ▾"}function f(){c.textContent="";for(const u of t){const p=document.createElement("button");p.type="button",p.className="themeOption",p.setAttribute("role","option"),p.setAttribute("data-id",u.id),p.setAttribute("aria-selected",u.id===l?"true":"false"),p.textContent=u.label,p.addEventListener("click",async()=>{await h(u.id),a(!1),o.focus({preventScroll:!0})}),c.appendChild(p)}}async function h(u){l=u,s(),f(),typeof n=="function"&&await n(u)}function m(u){if(!d)return;const p=u.target;p instanceof Node&&(e.contains(p)||a(!1))}function w(){a(!d)}function g(u){d&&u.key==="Escape"&&(u.preventDefault(),a(!1),o.focus({preventScroll:!0}))}return o.addEventListener("click",w),document.addEventListener("pointerdown",m),c.addEventListener("keydown",g),o.setAttribute("aria-haspopup","listbox"),c.setAttribute("role","listbox"),c.tabIndex=-1,s(),f(),a(!1),{setSelected:async u=>h(u),getSelected:()=>l,open:()=>a(!0),close:()=>a(!1),destroy:()=>{o.removeEventListener("click",w),document.removeEventListener("pointerdown",m),c.removeEventListener("keydown",g)}}}const Se="lasca.theme",me="lascaThemeCss";function Ue(r){const e="http://www.w3.org/2000/svg";let t=r.querySelector("defs");t||(t=document.createElementNS(e,"defs"),t.setAttribute("id","lascaDefs"),r.insertBefore(t,r.firstChild));let i=r.querySelector("#lascaThemeDefs");i||(i=document.createElementNS(e,"g"),i.setAttribute("id","lascaThemeDefs"),t.appendChild(i));let n=r.querySelector("#lascaRuntimeDefs");return n||(n=document.createElementNS(e,"g"),n.setAttribute("id","lascaRuntimeDefs"),t.appendChild(n)),{defs:t,themeDefs:i,runtimeDefs:n}}function _e(){let r=document.getElementById(me);return r&&r.tagName.toLowerCase()!=="link"&&(r.remove(),r=null),r||(r=document.createElement("link"),r.id=me,r.rel="stylesheet",document.head.appendChild(r)),r}function ge(){const r=localStorage.getItem(Se);return r||null}function $e(r){localStorage.setItem(Se,r)}function Ge(r){if(!r)throw new Error("createThemeManager: svgRoot is required");const{themeDefs:e}=Ue(r);let t=null,i=null;async function n(l){if(!l)return;const a=String(l);if(a===i)return;const s=_e();await new Promise(f=>{const h=()=>{s.removeEventListener("load",h),s.removeEventListener("error",h),f()};s.addEventListener("load",h),s.addEventListener("error",h),s.href=a}),i=a}async function o(l){const a=Q(l)??Q(ne);if(!a)throw new Error("No themes available.");if(t===a.id)return a;const s=r.style.visibility;return r.style.visibility="hidden",e.replaceChildren(),await We(e,[a.piecesDefs,a.boardDefs]),await n(a.css),t=a.id,$e(t),r.style.visibility=s||"visible",a}async function c(l){if(!l)return;const a=ie.map(m=>({id:m.id,label:m.label})),s=ge(),f=s&&Q(s)?s:ne;await o(f),await Fe({rootEl:l,items:a,initialId:f,onSelect:async m=>{await o(m)}}).setSelected(f)}async function d(l){if(!l)return;l.textContent="";for(const f of ie){const h=document.createElement("option");h.value=f.id,h.textContent=f.label,l.appendChild(h)}const a=ge(),s=a&&Q(a)?a:ne;l.value=s,await o(s),l.addEventListener("change",async()=>{await o(l.value)})}return{setTheme:o,bindThemeDropdown:c,bindThemeSelect:d,getCurrentThemeId:()=>t}}const re="http://www.w3.org/2000/svg";function xe(r){const e=r.querySelector("#overlays");if(e)return e;const t=document.createElementNS(re,"g");t.id="overlays",t.setAttribute("pointer-events","none");const i=r.querySelector("#pieces");return i&&i.parentNode?i.nextSibling?i.parentNode.insertBefore(t,i.nextSibling):i.parentNode.appendChild(t):r.appendChild(t),t}function ee(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function ae(r){return document.getElementById(r)}function Pe(r,e){const t=ae(e);if(!t)return;const i=parseFloat(t.getAttribute("cx")||"0"),n=parseFloat(t.getAttribute("cy")||"0"),o=parseFloat(t.getAttribute("r")||"0"),c=document.createElementNS(re,"circle");c.setAttribute("cx",String(i)),c.setAttribute("cy",String(n)),c.setAttribute("r",String(o+6)),c.setAttribute("fill","none"),c.setAttribute("stroke","#66ccff"),c.setAttribute("stroke-width","3"),c.setAttribute("pointer-events","none"),r.appendChild(c)}function Re(r,e){for(const t of e){const i=ae(t);if(!i)continue;const n=parseFloat(i.getAttribute("cx")||"0"),o=parseFloat(i.getAttribute("cy")||"0"),c=parseFloat(i.getAttribute("r")||"0"),d=document.createElementNS(re,"circle");d.setAttribute("cx",String(n)),d.setAttribute("cy",String(o)),d.setAttribute("r",String(c+10)),d.setAttribute("fill","none"),d.setAttribute("stroke","#00e676"),d.setAttribute("stroke-width","3"),d.setAttribute("stroke-dasharray","4 3"),r.appendChild(d)}}function Ye(r,e,t="#ff9f40",i=4){const n=ae(e);if(!n)return;const o=parseFloat(n.getAttribute("cx")||"0"),c=parseFloat(n.getAttribute("cy")||"0"),d=parseFloat(n.getAttribute("r")||"0"),l=document.createElementNS(re,"circle");l.setAttribute("cx",String(o)),l.setAttribute("cy",String(c)),l.setAttribute("r",String(d+12)),l.setAttribute("fill","none"),l.setAttribute("stroke",t),l.setAttribute("stroke-width",String(i)),l.setAttribute("stroke-dasharray","6 4"),l.setAttribute("pointer-events","none"),r.appendChild(l)}function de(r){const e=/^r(\d+)c(\d+)$/.exec(r);if(!e)throw new Error(`Invalid node id: ${r}`);const t=Number(e[1]),i=Number(e[2]);if(!Number.isInteger(t)||!Number.isInteger(i))throw new Error(`Invalid node coordinates in id: ${r}`);return{r:t,c:i}}function te(r,e){return`r${r}c${e}`}function Z(r,e){return r>=0&&r<=6&&e>=0&&e<=6}function oe(r,e){return Z(r,e)&&(r+e)%2===0}function He(r){const e=[],t=n=>!r.board.has(n)||(r.board.get(n)??[]).length===0,i=n=>{const o=r.board.get(n);return!o||o.length===0?!1:o[o.length-1].owner!==r.toMove};for(const[n,o]of r.board.entries()){if(!o||o.length===0)continue;const c=o[o.length-1];if(c.owner!==r.toMove)continue;const{r:d,c:l}=de(n);let a=[];if(c.rank==="S"){const s=c.owner==="B"?2:-2;a=[{dr:s,dc:-2},{dr:s,dc:2}]}else a=[{dr:-2,dc:-2},{dr:-2,dc:2},{dr:2,dc:-2},{dr:2,dc:2}];for(const{dr:s,dc:f}of a){const h=d+s/2,m=l+f/2,w=d+s,g=l+f;if(!Z(h,m)||!Z(w,g)||!oe(w,g))continue;const u=te(h,m),p=te(w,g);i(u)&&t(p)&&e.push({kind:"capture",from:n,over:u,to:p})}}return e}function be(r){const e=He(r);if(e.length>0)return e;const t=[],i=n=>!r.board.has(n)||(r.board.get(n)??[]).length===0;for(const[n,o]of r.board.entries()){if(!o||o.length===0)continue;const c=o[o.length-1];if(c.owner!==r.toMove)continue;const{r:d,c:l}=de(n),a=[];if(c.rank==="S"){const s=c.owner==="B"?1:-1;for(const f of[-1,1]){const h=d+s,m=l+f;if(Z(h,m)&&oe(h,m)){const w=te(h,m);i(w)&&a.push(w)}}}else{const s=[{dr:-1,dc:-1},{dr:-1,dc:1},{dr:1,dc:-1},{dr:1,dc:1}];for(const{dr:f,dc:h}of s){const m=d+f,w=l+h;if(Z(m,w)&&oe(m,w)){const g=te(m,w);i(g)&&a.push(g)}}}for(const s of a)t.push({from:n,to:s,kind:"move"})}return t}function we(r,e){const t=r.board.get(e);if(!t||t.length===0)return!1;const i=t[t.length-1];if(i.rank!=="S")return!1;const{r:n}=de(e);let o=!1;return(i.owner==="B"&&n===6||i.owner==="W"&&n===0)&&(o=!0),o?(i.rank="O",!0):!1}function Xe(r,e){if(e.kind==="capture"){const d=new Map(r.board),l=d.get(e.from);if(!l||l.length===0)throw new Error(`applyMove: no moving stack at ${e.from}`);const a=d.get(e.over);if(!a||a.length===0)throw new Error(`applyMove: no enemy stack to capture at ${e.over}`);const s=d.get(e.to);if(s&&s.length>0)throw new Error(`applyMove: landing square ${e.to} is not empty`);const f=a.pop();a.length===0?d.delete(e.over):d.set(e.over,a),d.set(e.to,l),l.unshift(f),d.delete(e.from);const h={...r,board:d},m=we(h,e.to);return{board:d,toMove:r.toMove,phase:"idle",didPromote:m}}const t=new Map(r.board),i=t.get(e.from);if(!i||i.length===0)return r;t.set(e.to,i),t.delete(e.from);const n={...r,board:t},o=we(n,e.to),c=r.toMove==="B"?"W":"B";return{board:t,toMove:c,phase:"idle",didPromote:o}}const Ke={stopCaptureOnPromotion:!0};class je{constructor(e,t,i,n){this.selected=null,this.currentTargets=[],this.currentMoves=[],this.mandatoryCapture=!1,this.lockedCaptureFrom=null,this.bannerTimer=null,this.remainderTimer=null,this.svg=e,this.piecesLayer=t,this.inspector=i,this.overlayLayer=xe(e),this.state=n}bind(){this.svg.addEventListener("click",e=>this.onClick(e))}setState(e){this.state=e,this.updatePanel()}updatePanel(){const e=document.getElementById("statusTurn"),t=document.getElementById("statusPhase"),i=document.getElementById("statusMessage");e&&(e.textContent=this.state.toMove==="B"?"Black":"White"),t&&(t.textContent=this.selected?"Select":"Idle"),i&&(this.selected?this.currentTargets.length>0?this.lockedCaptureFrom?i.textContent="Continue capturing":i.textContent="Choose a destination":this.mandatoryCapture?i.textContent="Capture required — select a capturing stack":i.textContent="No moves":i.textContent="—")}resolveClickedNode(e){if(e&&e instanceof Element){const t=e.closest("[data-node]");if(t){const n=t.getAttribute("data-node");if(n)return n}const i=e.closest("g.stack");if(i){const n=i.getAttribute("data-node");if(n)return n}if(e instanceof SVGCircleElement){const n=e.getAttribute("id");if(n)return n}}return null}svgPointFromClient(e){const t=this.svg.createSVGPoint?this.svg.createSVGPoint():null;if(t&&this.svg.getScreenCTM){t.x=e.clientX,t.y=e.clientY;const n=this.svg.getScreenCTM();if(n&&n.inverse){const o=t.matrixTransform(n.inverse());return{x:o.x,y:o.y}}}const i=this.svg.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}hitTestTargets(e){if(!this.selected||this.currentTargets.length===0)return null;const{x:t,y:i}=this.svgPointFromClient(e);for(const n of this.currentTargets){const o=document.getElementById(n);if(!o)continue;const c=parseFloat(o.getAttribute("cx")||"0"),d=parseFloat(o.getAttribute("cy")||"0"),l=parseFloat(o.getAttribute("r")||"0"),a=t-c,s=i-d;if(Math.sqrt(a*a+s*s)<=l+12)return n}return null}isOwnStack(e){const t=this.state.board.get(e);return!t||t.length===0?!1:t[t.length-1].owner===this.state.toMove}showSelection(e){ee(this.overlayLayer),Pe(this.overlayLayer,e);const t=be(this.state);this.mandatoryCapture=t.length>0&&t[0].kind==="capture";let i=t.filter(n=>n.from===e);this.lockedCaptureFrom&&this.lockedCaptureFrom!==e&&(i=[]),this.currentMoves=i,this.currentTargets=this.currentMoves.map(n=>n.to),Re(this.overlayLayer,this.currentTargets),this.updatePanel()}clearSelection(){this.selected=null,this.currentTargets=[],this.currentMoves=[],this.mandatoryCapture=!1,this.lockedCaptureFrom=null,ee(this.overlayLayer),this.updatePanel()}showBanner(e,t=1500){const i=document.getElementById("statusMessage");i&&(i.textContent=e),this.bannerTimer&&window.clearTimeout(this.bannerTimer),this.bannerTimer=window.setTimeout(()=>{this.bannerTimer=null,this.updatePanel()},t)}showRemainderHint(e,t=1200){Ye(this.overlayLayer,e,"#ff9f40",4),this.remainderTimer&&window.clearTimeout(this.remainderTimer),this.remainderTimer=window.setTimeout(()=>{this.remainderTimer=null,ee(this.overlayLayer),this.updatePanel()},t)}onClick(e){let t=this.resolveClickedNode(e.target);if(t||(t=this.hitTestTargets(e)),!t){this.clearSelection();return}if(this.selected&&this.currentTargets.includes(t)){const i=this.currentMoves.find(o=>o.to===t&&o.from===this.selected);if(!i){this.clearSelection();return}const n=Xe(this.state,i);if(this.state=n,ke(this.svg,this.piecesLayer,this.inspector,this.state),this.remainderTimer&&(window.clearTimeout(this.remainderTimer),this.remainderTimer=null),ee(this.overlayLayer),i.kind==="capture"){const o=n.didPromote||!1,d=be(this.state).filter(l=>l.kind==="capture").filter(l=>l.from===i.to);if(o&&Ke.stopCaptureOnPromotion){this.state={...this.state,toMove:this.state.toMove==="B"?"W":"B"},this.lockedCaptureFrom=null,this.clearSelection(),this.showBanner("Promoted — capture turn ends");return}if(d.length>0){this.lockedCaptureFrom=i.to,this.selected=i.to,this.showSelection(i.to),this.showBanner("Continue capture");return}this.state={...this.state,toMove:this.state.toMove==="B"?"W":"B"},this.lockedCaptureFrom=null,this.clearSelection(),this.showBanner("Turn changed")}else this.clearSelection();return}this.isOwnStack(t)?(this.selected=t,this.showSelection(t)):this.clearSelection()}}window.addEventListener("DOMContentLoaded",async()=>{const r=document.getElementById("boardWrap");if(!r)throw new Error("Missing board container: #boardWrap");const e=new URL(""+new URL("lasca_board-C7LnMF4x.svg",import.meta.url).href,import.meta.url),t=await Oe(r,e),i=document.getElementById("zoomTitle"),n=document.getElementById("zoomHint"),o=document.getElementById("zoomBody");if(!o)throw new Error("Missing inspector container: #zoomBody");const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.id="zoomSvg",c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("viewBox","0 0 120 200"),c.setAttribute("role","img"),c.setAttribute("aria-label","Stack column"),o.replaceChildren(c),De();const d=document.getElementById("themeDropdown");await Ge(t).bindThemeDropdown(d);const a=t.querySelector("#pieces");if(!a)throw new Error("Missing SVG group inside board: #pieces");if(!i||!n)throw new Error("Missing inspector DOM nodes (zoomTitle/zoomHint)");const s=Me(i,n,c),f=Ee(),h=document.getElementById("statusTurn"),m=document.getElementById("statusPhase"),w=document.getElementById("statusMessage");h&&(h.textContent=f.toMove==="B"?"Black":"White"),m&&(m.textContent=f.phase.charAt(0).toUpperCase()+f.phase.slice(1)),w&&(w.textContent="—"),ke(t,a,s,f),xe(t),new je(t,a,s,f).bind()});
